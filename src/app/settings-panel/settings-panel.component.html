<ng-container *ngIf="{
    hasVoiceRecognition: hasVoiceRecognition$ | async,
    highlightColors: highlightColors$ | async,
    settingsForm: settingsForm$ | async,
    techs: techs$ | async
} as data">
    <div class="header">
        <h2>Settings</h2>
        <button mat-icon-button (click)="close(data.settingsForm!, !!data.hasVoiceRecognition)">
            <mat-icon>close</mat-icon>
        </button>
    </div>

    <mat-divider></mat-divider>

    <form [formGroup]="data.settingsForm!.controls.enabledTechs">
        <p>Knowledge base</p>
        <p *ngFor="let tech of data.techs">
            <mat-slide-toggle [formControlName]="tech" color="primary">
                <tech-label [tech]="tech"></tech-label>
            </mat-slide-toggle>
        </p>
    </form>

    <mat-slide-toggle class="control" [formControl]="hasVoiceRecognition" color="primary">
        Voice recognition panel
    </mat-slide-toggle>

    <form [formGroup]="data.settingsForm!.controls.colors">
        <p><i class="highlight-example">Italics highlight</i></p>
        <p>
            <mat-label>Text</mat-label>
            <input
                matInput
                [formControl]="colorsForm.controls.textHighlightColor"
                [value]="data.highlightColors!.textHighlightColor!"
                [colorPicker]="data.highlightColors!.textHighlightColor!"
                cpPosition="bottom"
                (colorPickerChange)="changeTextHighlightColor($event)"/>
        </p>
        <p>
            <mat-label>Background</mat-label>
            <input
                matInput
                [formControl]="colorsForm.controls.backgroundHighlightColor"
                [value]="data.highlightColors!.backgroundHighlightColor!"
                [colorPicker]="data.highlightColors!.textHighlightColor!"
                cpPosition="top"
                (colorPickerChange)="changeBackgroundHighlightColor($event)"/>
        </p>
    </form>

    <div class="footer">
        <mat-divider></mat-divider>
        <button mat-raised-button color="primary" (click)="saveSettings(data.settingsForm!)">Save</button>
    </div>
</ng-container>